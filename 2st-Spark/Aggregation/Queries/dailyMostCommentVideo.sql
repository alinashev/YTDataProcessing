SELECT DISTINCT video_id, time_id, MAX(comment_count) FROM {temp_view_name} GROUP BY time_id, video_id ORDER BY time_id